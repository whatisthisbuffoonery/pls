<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Beej's Guide to C Programming</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!-- BG custom styling -->
  <style type="text/css">
  /* Fix for line numbers not visible */
  pre.numberSource code > span {
      left: -1em;
  }
  pre.numberSource {
      margin-left: initial;
  }

  /* Put some space after the section numbers */
  span.toc-section-number::after {
      content: "\a0\a0\a0";  /* non-breaking whitespace */
  }

  /* Hide underlines on code number links */
  pre > code.sourceCode > span > a:first-child::before {
      text-decoration: none;
  }

  /* Color the source blocks */
  div.sourceCode {
      background-color: #f0f0f0;
  }

  /* Fix iOS big text rendering issue */
  pre > code.sourceCode > span {
      display: initial;
  }


  /* Color the inline code */
  code:not(.sourceCode) {
      background: #f0f0f0;
      padding-left: 0.2em;
      padding-right: 0.2em;
      border-radius: 0.2em;
  }

  pre.sourceCode {
      border: 1px solid #ccc;
      padding: 0.5em;
      border-radius: 0.2em;
  }

  /* Keep code tags from wrapping in tables */
  tbody code {
      white-space: nowrap;
  }

  /* Prevent hyphenation and hyphen breaks in code*/
  code {
      word-break: keep-all;
  }

  td {
      vertical-align: top;
  }

  body {
      font-size: 12pt;
      max-width: 43em;
      font-family: sans-serif;
  }

  html {
      background: #f9f9f9;
  }

  figure > embed {
      max-width: 100%;
  }

  figure {
      text-align: center;
      margin-top: 2em;
      margin-bottom: 2em;
  }

  figcaption {
      font-size: 0.9em;
      font-style: italic;
      margin-top: 0.6em;
  }

  body {
      counter-reset: figure-counter-major;
      counter-reset: figure-counter-minor;
  }

  figure {
      counter-increment: figure-counter-minor;
  }

  figcaption::before {
      content: "Figure " counter(figure-counter-major) "." counter(figure-counter-minor) ": ";
  }

  blockquote {
      border-left: 2px solid #bbb;
      color: #444;
  }

  /* Contents */

  nav[role="doc-toc"] > ul > li {
    font-weight: bold;
    margin-top: 1.2em;
  }

  nav[role="doc-toc"] > ul > li:first {
    font-weight: bold;
    margin-top: initial;
  }

  nav[role="doc-toc"] > ul > li > ul {
    font-weight: normal;
    margin-top: 0.3em;
  }

  /*
  In multipage, we need to reset the figure counter to the chapter
  number. Luckily, this is in the <h1 data-number> attribute. Unluckily,
  there is no way to get this in a general way.

  This doesn't work:

    h1[data-number] {
      counter-set: figure-counter-major attr(data-number);
    }

  Nor this:

    h1[data-number] {
      --figure-counter-major-value: attr(data-number);
      counter-set: figure-counter-major var(--figure-counter-major-value);
    }

  So, dumbly, we have a bunch of rules for all these sections, up to the
  maximum possible section.

  Here's a program to generate them:

    for (let i = 1; i < 100; i++)
        console.log(`h1[data-number="${i}"]{counter-set:figure-counter-major ${i};counter-reset:figure-counter-minor;}`);

  Note to self: never write a book with more than 99 frickin' chapters.
  */

  h1[data-number="1"]{counter-set:figure-counter-major 1;counter-reset:figure-counter-minor;}
  h1[data-number="2"]{counter-set:figure-counter-major 2;counter-reset:figure-counter-minor;}
  h1[data-number="3"]{counter-set:figure-counter-major 3;counter-reset:figure-counter-minor;}
  h1[data-number="4"]{counter-set:figure-counter-major 4;counter-reset:figure-counter-minor;}
  h1[data-number="5"]{counter-set:figure-counter-major 5;counter-reset:figure-counter-minor;}
  h1[data-number="6"]{counter-set:figure-counter-major 6;counter-reset:figure-counter-minor;}
  h1[data-number="7"]{counter-set:figure-counter-major 7;counter-reset:figure-counter-minor;}
  h1[data-number="8"]{counter-set:figure-counter-major 8;counter-reset:figure-counter-minor;}
  h1[data-number="9"]{counter-set:figure-counter-major 9;counter-reset:figure-counter-minor;}
  h1[data-number="10"]{counter-set:figure-counter-major 10;counter-reset:figure-counter-minor;}
  h1[data-number="11"]{counter-set:figure-counter-major 11;counter-reset:figure-counter-minor;}
  h1[data-number="12"]{counter-set:figure-counter-major 12;counter-reset:figure-counter-minor;}
  h1[data-number="13"]{counter-set:figure-counter-major 13;counter-reset:figure-counter-minor;}
  h1[data-number="14"]{counter-set:figure-counter-major 14;counter-reset:figure-counter-minor;}
  h1[data-number="15"]{counter-set:figure-counter-major 15;counter-reset:figure-counter-minor;}
  h1[data-number="16"]{counter-set:figure-counter-major 16;counter-reset:figure-counter-minor;}
  h1[data-number="17"]{counter-set:figure-counter-major 17;counter-reset:figure-counter-minor;}
  h1[data-number="18"]{counter-set:figure-counter-major 18;counter-reset:figure-counter-minor;}
  h1[data-number="19"]{counter-set:figure-counter-major 19;counter-reset:figure-counter-minor;}
  h1[data-number="20"]{counter-set:figure-counter-major 20;counter-reset:figure-counter-minor;}
  h1[data-number="21"]{counter-set:figure-counter-major 21;counter-reset:figure-counter-minor;}
  h1[data-number="22"]{counter-set:figure-counter-major 22;counter-reset:figure-counter-minor;}
  h1[data-number="23"]{counter-set:figure-counter-major 23;counter-reset:figure-counter-minor;}
  h1[data-number="24"]{counter-set:figure-counter-major 24;counter-reset:figure-counter-minor;}
  h1[data-number="25"]{counter-set:figure-counter-major 25;counter-reset:figure-counter-minor;}
  h1[data-number="26"]{counter-set:figure-counter-major 26;counter-reset:figure-counter-minor;}
  h1[data-number="27"]{counter-set:figure-counter-major 27;counter-reset:figure-counter-minor;}
  h1[data-number="28"]{counter-set:figure-counter-major 28;counter-reset:figure-counter-minor;}
  h1[data-number="29"]{counter-set:figure-counter-major 29;counter-reset:figure-counter-minor;}
  h1[data-number="30"]{counter-set:figure-counter-major 30;counter-reset:figure-counter-minor;}
  h1[data-number="31"]{counter-set:figure-counter-major 31;counter-reset:figure-counter-minor;}
  h1[data-number="32"]{counter-set:figure-counter-major 32;counter-reset:figure-counter-minor;}
  h1[data-number="33"]{counter-set:figure-counter-major 33;counter-reset:figure-counter-minor;}
  h1[data-number="34"]{counter-set:figure-counter-major 34;counter-reset:figure-counter-minor;}
  h1[data-number="35"]{counter-set:figure-counter-major 35;counter-reset:figure-counter-minor;}
  h1[data-number="36"]{counter-set:figure-counter-major 36;counter-reset:figure-counter-minor;}
  h1[data-number="37"]{counter-set:figure-counter-major 37;counter-reset:figure-counter-minor;}
  h1[data-number="38"]{counter-set:figure-counter-major 38;counter-reset:figure-counter-minor;}
  h1[data-number="39"]{counter-set:figure-counter-major 39;counter-reset:figure-counter-minor;}
  h1[data-number="40"]{counter-set:figure-counter-major 40;counter-reset:figure-counter-minor;}
  h1[data-number="41"]{counter-set:figure-counter-major 41;counter-reset:figure-counter-minor;}
  h1[data-number="42"]{counter-set:figure-counter-major 42;counter-reset:figure-counter-minor;}
  h1[data-number="43"]{counter-set:figure-counter-major 43;counter-reset:figure-counter-minor;}
  h1[data-number="44"]{counter-set:figure-counter-major 44;counter-reset:figure-counter-minor;}
  h1[data-number="45"]{counter-set:figure-counter-major 45;counter-reset:figure-counter-minor;}
  h1[data-number="46"]{counter-set:figure-counter-major 46;counter-reset:figure-counter-minor;}
  h1[data-number="47"]{counter-set:figure-counter-major 47;counter-reset:figure-counter-minor;}
  h1[data-number="48"]{counter-set:figure-counter-major 48;counter-reset:figure-counter-minor;}
  h1[data-number="49"]{counter-set:figure-counter-major 49;counter-reset:figure-counter-minor;}
  h1[data-number="50"]{counter-set:figure-counter-major 50;counter-reset:figure-counter-minor;}
  h1[data-number="51"]{counter-set:figure-counter-major 51;counter-reset:figure-counter-minor;}
  h1[data-number="52"]{counter-set:figure-counter-major 52;counter-reset:figure-counter-minor;}
  h1[data-number="53"]{counter-set:figure-counter-major 53;counter-reset:figure-counter-minor;}
  h1[data-number="54"]{counter-set:figure-counter-major 54;counter-reset:figure-counter-minor;}
  h1[data-number="55"]{counter-set:figure-counter-major 55;counter-reset:figure-counter-minor;}
  h1[data-number="56"]{counter-set:figure-counter-major 56;counter-reset:figure-counter-minor;}
  h1[data-number="57"]{counter-set:figure-counter-major 57;counter-reset:figure-counter-minor;}
  h1[data-number="58"]{counter-set:figure-counter-major 58;counter-reset:figure-counter-minor;}
  h1[data-number="59"]{counter-set:figure-counter-major 59;counter-reset:figure-counter-minor;}
  h1[data-number="60"]{counter-set:figure-counter-major 60;counter-reset:figure-counter-minor;}
  h1[data-number="61"]{counter-set:figure-counter-major 61;counter-reset:figure-counter-minor;}
  h1[data-number="62"]{counter-set:figure-counter-major 62;counter-reset:figure-counter-minor;}
  h1[data-number="63"]{counter-set:figure-counter-major 63;counter-reset:figure-counter-minor;}
  h1[data-number="64"]{counter-set:figure-counter-major 64;counter-reset:figure-counter-minor;}
  h1[data-number="65"]{counter-set:figure-counter-major 65;counter-reset:figure-counter-minor;}
  h1[data-number="66"]{counter-set:figure-counter-major 66;counter-reset:figure-counter-minor;}
  h1[data-number="67"]{counter-set:figure-counter-major 67;counter-reset:figure-counter-minor;}
  h1[data-number="68"]{counter-set:figure-counter-major 68;counter-reset:figure-counter-minor;}
  h1[data-number="69"]{counter-set:figure-counter-major 69;counter-reset:figure-counter-minor;}
  h1[data-number="70"]{counter-set:figure-counter-major 70;counter-reset:figure-counter-minor;}
  h1[data-number="71"]{counter-set:figure-counter-major 71;counter-reset:figure-counter-minor;}
  h1[data-number="72"]{counter-set:figure-counter-major 72;counter-reset:figure-counter-minor;}
  h1[data-number="73"]{counter-set:figure-counter-major 73;counter-reset:figure-counter-minor;}
  h1[data-number="74"]{counter-set:figure-counter-major 74;counter-reset:figure-counter-minor;}
  h1[data-number="75"]{counter-set:figure-counter-major 75;counter-reset:figure-counter-minor;}
  h1[data-number="76"]{counter-set:figure-counter-major 76;counter-reset:figure-counter-minor;}
  h1[data-number="77"]{counter-set:figure-counter-major 77;counter-reset:figure-counter-minor;}
  h1[data-number="78"]{counter-set:figure-counter-major 78;counter-reset:figure-counter-minor;}
  h1[data-number="79"]{counter-set:figure-counter-major 79;counter-reset:figure-counter-minor;}
  h1[data-number="80"]{counter-set:figure-counter-major 80;counter-reset:figure-counter-minor;}
  h1[data-number="81"]{counter-set:figure-counter-major 81;counter-reset:figure-counter-minor;}
  h1[data-number="82"]{counter-set:figure-counter-major 82;counter-reset:figure-counter-minor;}
  h1[data-number="83"]{counter-set:figure-counter-major 83;counter-reset:figure-counter-minor;}
  h1[data-number="84"]{counter-set:figure-counter-major 84;counter-reset:figure-counter-minor;}
  h1[data-number="85"]{counter-set:figure-counter-major 85;counter-reset:figure-counter-minor;}
  h1[data-number="86"]{counter-set:figure-counter-major 86;counter-reset:figure-counter-minor;}
  h1[data-number="87"]{counter-set:figure-counter-major 87;counter-reset:figure-counter-minor;}
  h1[data-number="88"]{counter-set:figure-counter-major 88;counter-reset:figure-counter-minor;}
  h1[data-number="89"]{counter-set:figure-counter-major 89;counter-reset:figure-counter-minor;}
  h1[data-number="90"]{counter-set:figure-counter-major 90;counter-reset:figure-counter-minor;}
  h1[data-number="91"]{counter-set:figure-counter-major 91;counter-reset:figure-counter-minor;}
  h1[data-number="92"]{counter-set:figure-counter-major 92;counter-reset:figure-counter-minor;}
  h1[data-number="93"]{counter-set:figure-counter-major 93;counter-reset:figure-counter-minor;}
  h1[data-number="94"]{counter-set:figure-counter-major 94;counter-reset:figure-counter-minor;}
  h1[data-number="95"]{counter-set:figure-counter-major 95;counter-reset:figure-counter-minor;}
  h1[data-number="96"]{counter-set:figure-counter-major 96;counter-reset:figure-counter-minor;}
  h1[data-number="97"]{counter-set:figure-counter-major 97;counter-reset:figure-counter-minor;}
  h1[data-number="98"]{counter-set:figure-counter-major 98;counter-reset:figure-counter-minor;}
  h1[data-number="99"]{counter-set:figure-counter-major 99;counter-reset:figure-counter-minor;}


  </style>
  <!-- BG custom styling for the wide body variant -->
  <!-- Gets appended after bg-css.html -->

  <style type="text/css">
  body {
      max-width: inherit;
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body>
<div style="text-align:center"><span><a href="variable-length-arrays-vlas.html" rel="prev">Prev</a> | </span><a href="index.html">Contents</a><span> | <a href="types-part-v-compound-literals-and-generic-selections.html" rel="next">Next</a></span></div><hr>
<h1 data-number="31" id="goto"><span class="header-section-number">31</span> <code>goto</code></h1>
<p></p>
<p>The <code>goto</code> statement is universally revered and can be here presented without contest.</p>
<p>Just kidding! Over the years, there has been a lot of back-and-forth over whether or not (often not) <code>goto</code> is <a href="https://en.wikipedia.org/wiki/Goto#Criticism">considered harmful</a><a href="function-specifiers-alignment-specifiersoperators.html#fn176" class="footnote-ref" id="fnref176" role="doc-noteref"><sup>176</sup></a>.</p>
<p>In this programmer’s opinion, you should use whichever constructs leads to the <em>best</em> code, factoring in maintainability and speed. And sometimes this might be <code>goto</code>!</p>
<p>In this chapter, we’ll see how <code>goto</code> works in C, and then check out some of the common cases where it is used<a href="function-specifiers-alignment-specifiersoperators.html#fn177" class="footnote-ref" id="fnref177" role="doc-noteref"><sup>177</sup></a>.</p>
<h2 data-number="31.1" id="a-simple-example"><span class="header-section-number">31.1</span> A Simple Example</h2>
<p></p>
<p>In this example, we’re going to use <code>goto</code> to skip a line of code and jump to a <em>label</em>. The label is the identifier that can be a <code>goto</code> target—it ends with a colon (<code>:</code>).</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb608-1"><a href="goto.html#cb608-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb608-2"><a href="goto.html#cb608-2"></a></span>
<span id="cb608-3"><a href="goto.html#cb608-3"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb608-4"><a href="goto.html#cb608-4"></a><span class="op">{</span></span>
<span id="cb608-5"><a href="goto.html#cb608-5"></a>    printf<span class="op">(</span><span class="st">&quot;One</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb608-6"><a href="goto.html#cb608-6"></a>    printf<span class="op">(</span><span class="st">&quot;Two</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb608-7"><a href="goto.html#cb608-7"></a></span>
<span id="cb608-8"><a href="goto.html#cb608-8"></a>    <span class="cf">goto</span> skip_3<span class="op">;</span></span>
<span id="cb608-9"><a href="goto.html#cb608-9"></a></span>
<span id="cb608-10"><a href="goto.html#cb608-10"></a>    printf<span class="op">(</span><span class="st">&quot;Three</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb608-11"><a href="goto.html#cb608-11"></a></span>
<span id="cb608-12"><a href="goto.html#cb608-12"></a>skip_3<span class="op">:</span></span>
<span id="cb608-13"><a href="goto.html#cb608-13"></a></span>
<span id="cb608-14"><a href="goto.html#cb608-14"></a>    printf<span class="op">(</span><span class="st">&quot;Five!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb608-15"><a href="goto.html#cb608-15"></a><span class="op">}</span></span></code></pre></div>
<p>The output is:</p>
<div class="sourceCode" id="cb609"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb609-1"><a href="goto.html#cb609-1" aria-hidden="true" tabindex="-1"></a>One</span>
<span id="cb609-2"><a href="goto.html#cb609-2" aria-hidden="true" tabindex="-1"></a>Two</span>
<span id="cb609-3"><a href="goto.html#cb609-3" aria-hidden="true" tabindex="-1"></a>Five!</span></code></pre></div>
<p><code>goto</code> sends execution jumping to the specified label, skipping everything in between.</p>
<p>You can jump forward or backward with <code>goto</code>.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb610-1"><a href="goto.html#cb610-1" aria-hidden="true" tabindex="-1"></a>infinite_loop<span class="op">:</span></span>
<span id="cb610-2"><a href="goto.html#cb610-2" aria-hidden="true" tabindex="-1"></a>    print<span class="op">(</span><span class="st">&quot;Hello, world!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb610-3"><a href="goto.html#cb610-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">goto</span> infinite_loop<span class="op">;</span></span></code></pre></div>
<p>Labels are skipped over during execution. The following will print all three numbers in order just as if the labels weren’t there:</p>
<div class="sourceCode" id="cb611"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb611-1"><a href="goto.html#cb611-1" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Zero</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb611-2"><a href="goto.html#cb611-2" aria-hidden="true" tabindex="-1"></a>label_1<span class="op">:</span></span>
<span id="cb611-3"><a href="goto.html#cb611-3" aria-hidden="true" tabindex="-1"></a>label_2<span class="op">:</span></span>
<span id="cb611-4"><a href="goto.html#cb611-4" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;One</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb611-5"><a href="goto.html#cb611-5" aria-hidden="true" tabindex="-1"></a>label_3<span class="op">:</span></span>
<span id="cb611-6"><a href="goto.html#cb611-6" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Two</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb611-7"><a href="goto.html#cb611-7" aria-hidden="true" tabindex="-1"></a>label_4<span class="op">:</span></span>
<span id="cb611-8"><a href="goto.html#cb611-8" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Three</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span></code></pre></div>
<p>As you’ve noticed, it’s common convention to justify the labels all the way on the left. This increases readability because a reader can quickly scan to find the destination.</p>
<p>Labels have <em>function scope</em>. That is, no matter how many levels deep in blocks they appear, you can still <code>goto</code> them from anywhere in the function.</p>
<p>It also means you can only <code>goto</code> labels that are in the same function as the <code>goto</code> itself. Labels in other functions are out of scope from <code>goto</code>’s perspective. And it means you can use the same label name in two functions—just not the same label name in the same function.</p>
<p></p>
<h2 data-number="31.2" id="labeled-continue"><span class="header-section-number">31.2</span> Labeled <code>continue</code></h2>
<p></p>
<p>In some languages, you can actually specify a label for a <code>continue</code> statement. C doesn’t allow it, but you can easily use <code>goto</code> instead.</p>
<p>To show the issue, check out <code>continue</code> in this nested loop:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb612-1"><a href="goto.html#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb612-2"><a href="goto.html#cb612-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb612-3"><a href="goto.html#cb612-3" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> j<span class="op">);</span></span>
<span id="cb612-4"><a href="goto.html#cb612-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">continue</span><span class="op">;</span>   <span class="co">// Always goes to next j</span></span>
<span id="cb612-5"><a href="goto.html#cb612-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb612-6"><a href="goto.html#cb612-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>As we see, that <code>continue</code>, like all <code>continues</code>, goes to the next iteration of the nearest enclosing loop. What if we want to <code>continue</code> in the next loop out, the loop with <code>i</code>?</p>
<p>Well, we can <code>break</code> to get back to the outer loop, right?</p>
<div class="sourceCode" id="cb613"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb613-1"><a href="goto.html#cb613-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb613-2"><a href="goto.html#cb613-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb613-3"><a href="goto.html#cb613-3" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> j<span class="op">);</span></span>
<span id="cb613-4"><a href="goto.html#cb613-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span>     <span class="co">// Gets us to the next iteration of i</span></span>
<span id="cb613-5"><a href="goto.html#cb613-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb613-6"><a href="goto.html#cb613-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>That gets us two levels of nested loop. But then if we nest another loop, we’re out of options. What about this, where we don’t have any statement that will get us out to the next iteration of <code>i</code>?</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb614-1"><a href="goto.html#cb614-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb614-2"><a href="goto.html#cb614-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb614-3"><a href="goto.html#cb614-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb614-4"><a href="goto.html#cb614-4" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> j<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb614-5"><a href="goto.html#cb614-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-6"><a href="goto.html#cb614-6" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span><span class="op">;</span>  <span class="co">// Gets us to the next iteration of k</span></span>
<span id="cb614-7"><a href="goto.html#cb614-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span>     <span class="co">// Gets us to the next iteration of j</span></span>
<span id="cb614-8"><a href="goto.html#cb614-8" aria-hidden="true" tabindex="-1"></a>            <span class="op">????;</span>      <span class="co">// Gets us to the next iteration of i???</span></span>
<span id="cb614-9"><a href="goto.html#cb614-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb614-10"><a href="goto.html#cb614-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb614-11"><a href="goto.html#cb614-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb614-12"><a href="goto.html#cb614-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>The <code>goto</code> statement offers us a way!</p>
<div class="sourceCode" id="cb615"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb615-1"><a href="goto.html#cb615-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb615-2"><a href="goto.html#cb615-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb615-3"><a href="goto.html#cb615-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> k <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> k <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> k<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb615-4"><a href="goto.html#cb615-4" aria-hidden="true" tabindex="-1"></a>                printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> j<span class="op">,</span> k<span class="op">);</span></span>
<span id="cb615-5"><a href="goto.html#cb615-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb615-6"><a href="goto.html#cb615-6" aria-hidden="true" tabindex="-1"></a>                <span class="cf">goto</span> continue_i<span class="op">;</span>   <span class="co">// Now continuing the i loop!!</span></span>
<span id="cb615-7"><a href="goto.html#cb615-7" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb615-8"><a href="goto.html#cb615-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb615-9"><a href="goto.html#cb615-9" aria-hidden="true" tabindex="-1"></a>continue_i<span class="op">:</span> <span class="op">;</span></span>
<span id="cb615-10"><a href="goto.html#cb615-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>We have a <code>;</code> at the end there—that’s because you can’t have a label pointing to the plain end of a compound statement (or before a variable declaration).</p>
<p></p>
<h2 data-number="31.3" id="bailing-out"><span class="header-section-number">31.3</span> Bailing Out</h2>
<p></p>
<p>When you’re super nested in the middle of some code, you can use <code>goto</code> to get out of it in a manner that’s often cleaner than nesting more <code>if</code>s and using flag variables.</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb616-1"><a href="goto.html#cb616-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Pseudocode</span></span>
<span id="cb616-2"><a href="goto.html#cb616-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-3"><a href="goto.html#cb616-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(...)</span> <span class="op">{</span></span>
<span id="cb616-4"><a href="goto.html#cb616-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(...)</span> <span class="op">{</span></span>
<span id="cb616-5"><a href="goto.html#cb616-5" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> <span class="op">(...)</span> <span class="op">{</span></span>
<span id="cb616-6"><a href="goto.html#cb616-6" aria-hidden="true" tabindex="-1"></a>                <span class="cf">do</span> <span class="op">{</span></span>
<span id="cb616-7"><a href="goto.html#cb616-7" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="op">(</span>some_error_condition<span class="op">)</span></span>
<span id="cb616-8"><a href="goto.html#cb616-8" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">goto</span> bail<span class="op">;</span></span>
<span id="cb616-9"><a href="goto.html#cb616-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-10"><a href="goto.html#cb616-10" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span> <span class="cf">while</span><span class="op">(...);</span></span>
<span id="cb616-11"><a href="goto.html#cb616-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb616-12"><a href="goto.html#cb616-12" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb616-13"><a href="goto.html#cb616-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb616-14"><a href="goto.html#cb616-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb616-15"><a href="goto.html#cb616-15" aria-hidden="true" tabindex="-1"></a>bail<span class="op">:</span></span>
<span id="cb616-16"><a href="goto.html#cb616-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Cleanup here</span></span></code></pre></div>
<p>Without <code>goto</code>, you’d have to check an error condition flag in all of the loops to get all the way out.</p>
<p></p>
<h2 data-number="31.4" id="labeled-break"><span class="header-section-number">31.4</span> Labeled <code>break</code></h2>
<p></p>
<p>This is a very similar situation to how <code>continue</code> only continues the innermost loop. <code>break</code> also only breaks out of the innermost loop.</p>
<div class="sourceCode" id="cb617"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb617-1"><a href="goto.html#cb617-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb617-2"><a href="goto.html#cb617-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb617-3"><a href="goto.html#cb617-3" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> j<span class="op">);</span></span>
<span id="cb617-4"><a href="goto.html#cb617-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span>   <span class="co">// Only breaks out of the j loop</span></span>
<span id="cb617-5"><a href="goto.html#cb617-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb617-6"><a href="goto.html#cb617-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb617-7"><a href="goto.html#cb617-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb617-8"><a href="goto.html#cb617-8" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Done!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span></code></pre></div>
<p>But we can use <code>goto</code> to break farther:</p>
<div class="sourceCode" id="cb618"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb618-1"><a href="goto.html#cb618-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb618-2"><a href="goto.html#cb618-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> j<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb618-3"><a href="goto.html#cb618-3" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">, </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> j<span class="op">);</span></span>
<span id="cb618-4"><a href="goto.html#cb618-4" aria-hidden="true" tabindex="-1"></a>            <span class="cf">goto</span> break_i<span class="op">;</span>   <span class="co">// Now breaking out of the i loop!</span></span>
<span id="cb618-5"><a href="goto.html#cb618-5" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb618-6"><a href="goto.html#cb618-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb618-7"><a href="goto.html#cb618-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-8"><a href="goto.html#cb618-8" aria-hidden="true" tabindex="-1"></a>break_i<span class="op">:</span></span>
<span id="cb618-9"><a href="goto.html#cb618-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb618-10"><a href="goto.html#cb618-10" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Done!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span></code></pre></div>
<p></p>
<h2 data-number="31.5" id="multi-level-cleanup"><span class="header-section-number">31.5</span> Multi-level Cleanup</h2>
<p></p>
<p>If you’re calling multiple functions to initialize multiple systems and one of them fails, you should only de-initialize the ones that you’ve gotten to so far.</p>
<p>Let’s do a fake example where we start initializing systems and checking to see if any returns an error (we’ll use <code>-1</code> to indicate an error). If one of them does, we have to shutdown only the systems we’ve initialized so far.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb619-1"><a href="goto.html#cb619-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>init_system_1<span class="op">()</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb619-2"><a href="goto.html#cb619-2" aria-hidden="true" tabindex="-1"></a>        <span class="cf">goto</span> shutdown<span class="op">;</span></span>
<span id="cb619-3"><a href="goto.html#cb619-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-4"><a href="goto.html#cb619-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>init_system_2<span class="op">()</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb619-5"><a href="goto.html#cb619-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">goto</span> shutdown_1<span class="op">;</span></span>
<span id="cb619-6"><a href="goto.html#cb619-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-7"><a href="goto.html#cb619-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>init_system_3<span class="op">()</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb619-8"><a href="goto.html#cb619-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">goto</span> shutdown_2<span class="op">;</span></span>
<span id="cb619-9"><a href="goto.html#cb619-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-10"><a href="goto.html#cb619-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>init_system_4<span class="op">()</span> <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span></span>
<span id="cb619-11"><a href="goto.html#cb619-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">goto</span> shutdown_3<span class="op">;</span></span>
<span id="cb619-12"><a href="goto.html#cb619-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-13"><a href="goto.html#cb619-13" aria-hidden="true" tabindex="-1"></a>    do_main_thing<span class="op">();</span>   <span class="co">// Run our program</span></span>
<span id="cb619-14"><a href="goto.html#cb619-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-15"><a href="goto.html#cb619-15" aria-hidden="true" tabindex="-1"></a>    shutdown_system4<span class="op">();</span></span>
<span id="cb619-16"><a href="goto.html#cb619-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-17"><a href="goto.html#cb619-17" aria-hidden="true" tabindex="-1"></a>shutdown_3<span class="op">:</span></span>
<span id="cb619-18"><a href="goto.html#cb619-18" aria-hidden="true" tabindex="-1"></a>    shutdown_system3<span class="op">();</span></span>
<span id="cb619-19"><a href="goto.html#cb619-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-20"><a href="goto.html#cb619-20" aria-hidden="true" tabindex="-1"></a>shutdown_2<span class="op">:</span></span>
<span id="cb619-21"><a href="goto.html#cb619-21" aria-hidden="true" tabindex="-1"></a>    shutdown_system2<span class="op">();</span></span>
<span id="cb619-22"><a href="goto.html#cb619-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-23"><a href="goto.html#cb619-23" aria-hidden="true" tabindex="-1"></a>shutdown_1<span class="op">:</span></span>
<span id="cb619-24"><a href="goto.html#cb619-24" aria-hidden="true" tabindex="-1"></a>    shutdown_system1<span class="op">();</span></span>
<span id="cb619-25"><a href="goto.html#cb619-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb619-26"><a href="goto.html#cb619-26" aria-hidden="true" tabindex="-1"></a>shutdown<span class="op">:</span></span>
<span id="cb619-27"><a href="goto.html#cb619-27" aria-hidden="true" tabindex="-1"></a>    print<span class="op">(</span><span class="st">&quot;All subsystems shut down.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span></code></pre></div>
<p>Note that we’re shutting down in the reverse order that we initialized the subsystems. So if subsystem 4 fails to start up, it will shut down 3, 2, then 1 in that order.</p>
<p></p>
<h2 data-number="31.6" id="tail-call-optimization"><span class="header-section-number">31.6</span> Tail Call Optimization</h2>
<p> </p>
<p>Kinda. For recursive functions only.</p>
<p>If you’re unfamiliar, <a href="https://en.wikipedia.org/wiki/Tail_call">Tail Call Optimization (TCO)</a><a href="function-specifiers-alignment-specifiersoperators.html#fn178" class="footnote-ref" id="fnref178" role="doc-noteref"><sup>178</sup></a> is a way to not waste stack space when calling other functions under very specific circumstances. Unfortunately the details are beyond the scope of this guide.</p>
<p>But if you have a recursive function you know can be optimized in this way, you can make use of this technique. (Note that you can’t tail call other functions due to the function scope of labels.)</p>
<p>Let’s do a straightforward example, factorial.</p>
<p>Here’s a recursive version that’s not TCO, but it can be!</p>
<div class="sourceCode" id="cb620"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb620-1"><a href="goto.html#cb620-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb620-2"><a href="goto.html#cb620-2"></a><span class="pp">#include </span><span class="im">&lt;complex.h&gt;</span></span>
<span id="cb620-3"><a href="goto.html#cb620-3"></a></span>
<span id="cb620-4"><a href="goto.html#cb620-4"></a><span class="dt">int</span> factorial<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> a<span class="op">)</span></span>
<span id="cb620-5"><a href="goto.html#cb620-5"></a><span class="op">{</span></span>
<span id="cb620-6"><a href="goto.html#cb620-6"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb620-7"><a href="goto.html#cb620-7"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb620-8"><a href="goto.html#cb620-8"></a></span>
<span id="cb620-9"><a href="goto.html#cb620-9"></a>    <span class="cf">return</span> factorial<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> a <span class="op">*</span> n<span class="op">);</span></span>
<span id="cb620-10"><a href="goto.html#cb620-10"></a><span class="op">}</span></span>
<span id="cb620-11"><a href="goto.html#cb620-11"></a></span>
<span id="cb620-12"><a href="goto.html#cb620-12"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb620-13"><a href="goto.html#cb620-13"></a><span class="op">{</span></span>
<span id="cb620-14"><a href="goto.html#cb620-14"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb620-15"><a href="goto.html#cb620-15"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">! == </span><span class="sc">%ld\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> factorial<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb620-16"><a href="goto.html#cb620-16"></a><span class="op">}</span></span></code></pre></div>
<p>To make it happen, you can replace the call with two steps:</p>
<ol type="1">
<li>Set the values of the parameters to what they’d be on the next call.</li>
<li><code>goto</code> a label on the first line of the function.</li>
</ol>
<p>Let’s try it:</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode numberSource c numberLines"><code class="sourceCode c"><span id="cb621-1"><a href="goto.html#cb621-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb621-2"><a href="goto.html#cb621-2"></a></span>
<span id="cb621-3"><a href="goto.html#cb621-3"></a><span class="dt">int</span> factorial<span class="op">(</span><span class="dt">int</span> n<span class="op">,</span> <span class="dt">int</span> a<span class="op">)</span></span>
<span id="cb621-4"><a href="goto.html#cb621-4"></a><span class="op">{</span></span>
<span id="cb621-5"><a href="goto.html#cb621-5"></a>tco<span class="op">:</span>  <span class="co">// add this</span></span>
<span id="cb621-6"><a href="goto.html#cb621-6"></a></span>
<span id="cb621-7"><a href="goto.html#cb621-7"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span></span>
<span id="cb621-8"><a href="goto.html#cb621-8"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb621-9"><a href="goto.html#cb621-9"></a></span>
<span id="cb621-10"><a href="goto.html#cb621-10"></a>    <span class="co">// replace return by setting new parameter values and</span></span>
<span id="cb621-11"><a href="goto.html#cb621-11"></a>    <span class="co">// goto-ing the beginning of the function</span></span>
<span id="cb621-12"><a href="goto.html#cb621-12"></a></span>
<span id="cb621-13"><a href="goto.html#cb621-13"></a>    <span class="co">//return factorial(n - 1, a * n);</span></span>
<span id="cb621-14"><a href="goto.html#cb621-14"></a></span>
<span id="cb621-15"><a href="goto.html#cb621-15"></a>    <span class="dt">int</span> next_n <span class="op">=</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// See how these match up with</span></span>
<span id="cb621-16"><a href="goto.html#cb621-16"></a>    <span class="dt">int</span> next_a <span class="op">=</span> a <span class="op">*</span> n<span class="op">;</span>  <span class="co">// the recursive arguments, above?</span></span>
<span id="cb621-17"><a href="goto.html#cb621-17"></a></span>
<span id="cb621-18"><a href="goto.html#cb621-18"></a>    n <span class="op">=</span> next_n<span class="op">;</span>   <span class="co">// Set the parameters to the new values</span></span>
<span id="cb621-19"><a href="goto.html#cb621-19"></a>    a <span class="op">=</span> next_a<span class="op">;</span></span>
<span id="cb621-20"><a href="goto.html#cb621-20"></a></span>
<span id="cb621-21"><a href="goto.html#cb621-21"></a>    <span class="cf">goto</span> tco<span class="op">;</span>   <span class="co">// And repeat!</span></span>
<span id="cb621-22"><a href="goto.html#cb621-22"></a><span class="op">}</span></span>
<span id="cb621-23"><a href="goto.html#cb621-23"></a></span>
<span id="cb621-24"><a href="goto.html#cb621-24"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">void</span><span class="op">)</span></span>
<span id="cb621-25"><a href="goto.html#cb621-25"></a><span class="op">{</span></span>
<span id="cb621-26"><a href="goto.html#cb621-26"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> i<span class="op">++)</span></span>
<span id="cb621-27"><a href="goto.html#cb621-27"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d</span><span class="st">! == </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> i<span class="op">,</span> factorial<span class="op">(</span>i<span class="op">,</span> <span class="dv">1</span><span class="op">));</span></span>
<span id="cb621-28"><a href="goto.html#cb621-28"></a><span class="op">}</span></span></code></pre></div>
<p>I used temporary variables up there to set the next values of the parameters before jumping to the start of the function. See how they correspond to the recursive arguments that were in the recursive call?</p>
<p>Now, why use temp variables? I could have done this instead:</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb622-1"><a href="goto.html#cb622-1" aria-hidden="true" tabindex="-1"></a>    a <span class="op">*=</span> n<span class="op">;</span></span>
<span id="cb622-2"><a href="goto.html#cb622-2" aria-hidden="true" tabindex="-1"></a>    n <span class="op">-=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb622-3"><a href="goto.html#cb622-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb622-4"><a href="goto.html#cb622-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">goto</span> tco<span class="op">;</span></span></code></pre></div>
<p>and that actually works just fine. But if I carelessly reverse those two lines of code:</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb623-1"><a href="goto.html#cb623-1" aria-hidden="true" tabindex="-1"></a>    n <span class="op">-=</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// BAD NEWS</span></span>
<span id="cb623-2"><a href="goto.html#cb623-2" aria-hidden="true" tabindex="-1"></a>    a <span class="op">*=</span> n<span class="op">;</span></span></code></pre></div>
<p>—now we’re in trouble. We modified <code>n</code> before using it to modify <code>a</code>. That’s Bad because that’s not how it works when you call recursively. Using the temporary variables avoids this problem even if you’re not looking out for it. And the compiler likely optimizes them out, anyway.</p>
<p> </p>
<h2 data-number="31.7" id="restarting-interrupted-system-calls"><span class="header-section-number">31.7</span> Restarting Interrupted System Calls</h2>
<p></p>
<p>This is outside the spec, but commonly seen in Unix-like systems.</p>
<p>Certain long-lived system calls might return an error if they’re interrupted by a signal, and <code>errno</code> will be set to <code>EINTR</code> to indicate the syscall was doing fine; it was just interrupted.</p>
<p>In those cases, it’s really common for the programmer to want to restart the call and try it again.</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb624-1"><a href="goto.html#cb624-1" aria-hidden="true" tabindex="-1"></a>retry<span class="op">:</span></span>
<span id="cb624-2"><a href="goto.html#cb624-2" aria-hidden="true" tabindex="-1"></a>    byte_count <span class="op">=</span> read<span class="op">(</span><span class="dv">0</span><span class="op">,</span> buf<span class="op">,</span> <span class="kw">sizeof</span><span class="op">(</span>buf<span class="op">)</span> <span class="op">-</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// Unix read() syscall</span></span>
<span id="cb624-3"><a href="goto.html#cb624-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb624-4"><a href="goto.html#cb624-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>byte_count <span class="op">==</span> <span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span>            <span class="co">// An error occurred...</span></span>
<span id="cb624-5"><a href="goto.html#cb624-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>errno <span class="op">==</span> EINTR<span class="op">)</span> <span class="op">{</span>          <span class="co">// But it was just interrupted</span></span>
<span id="cb624-6"><a href="goto.html#cb624-6" aria-hidden="true" tabindex="-1"></a>            printf<span class="op">(</span><span class="st">&quot;Restarting...</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb624-7"><a href="goto.html#cb624-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">goto</span> retry<span class="op">;</span></span>
<span id="cb624-8"><a href="goto.html#cb624-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span></code></pre></div>
<p>Many Unix-likes have an <code>SA_RESTART</code> flag you can pass to <code>sigaction()</code> to request the OS automatically restart any slow syscalls instead of failing with <code>EINTR</code>.</p>
<p>Again, this is Unix-specific and is outside the C standard.</p>
<p>That said, it’s possible to use a similar technique any time any function should be restarted.</p>
<p></p>
<h2 data-number="31.8" id="goto-and-thread-preemption"><span class="header-section-number">31.8</span> <code>goto</code> and Thread Preemption</h2>
<p></p>
<p>This example is ripped directly from <a href="http://www.ostep.org/"><em>Operating Systems: Three Easy Pieces</em></a>, another excellent book from like-minded authors who also feel that quality books should be free to download. Not that I’m opinionated, or anything.</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb625-1"><a href="goto.html#cb625-1" aria-hidden="true" tabindex="-1"></a>retry<span class="op">:</span></span>
<span id="cb625-2"><a href="goto.html#cb625-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-3"><a href="goto.html#cb625-3" aria-hidden="true" tabindex="-1"></a>    pthread_mutex_lock<span class="op">(</span>L1<span class="op">);</span></span>
<span id="cb625-4"><a href="goto.html#cb625-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-5"><a href="goto.html#cb625-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>pthread_mutex_trylock<span class="op">(</span>L2<span class="op">)</span> <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb625-6"><a href="goto.html#cb625-6" aria-hidden="true" tabindex="-1"></a>        pthread_mutex_unlock<span class="op">(</span>L1<span class="op">);</span></span>
<span id="cb625-7"><a href="goto.html#cb625-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">goto</span> retry<span class="op">;</span></span>
<span id="cb625-8"><a href="goto.html#cb625-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb625-9"><a href="goto.html#cb625-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-10"><a href="goto.html#cb625-10" aria-hidden="true" tabindex="-1"></a>    save_the_day<span class="op">();</span></span>
<span id="cb625-11"><a href="goto.html#cb625-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb625-12"><a href="goto.html#cb625-12" aria-hidden="true" tabindex="-1"></a>    pthread_mutex_unlock<span class="op">(</span>L2<span class="op">);</span></span>
<span id="cb625-13"><a href="goto.html#cb625-13" aria-hidden="true" tabindex="-1"></a>    pthread_mutex_unlock<span class="op">(</span>L1<span class="op">);</span></span></code></pre></div>
<p>There the thread happily acquires the mutex <code>L1</code>, but then potentially fails to get the second resource guarded by mutex <code>L2</code> (if some other uncooperative thread holds it, say). If our thread can’t get the <code>L2</code> lock, it unlocks <code>L1</code> and then uses <code>goto</code> to cleanly retry.</p>
<p>We hope our heroic thread eventually manages to acquire both mutexes and save the day, all while avoiding evil deadlock.</p>
<p></p>
<h2 data-number="31.9" id="goto-and-variable-scope"><span class="header-section-number">31.9</span> <code>goto</code> and Variable Scope</h2>
<p></p>
<p>We’ve already seen that labels have function scope, but weird things can happen if we jump past some variable initialization.</p>
<p>Look at this example where we jump from a place where the variable <code>x</code> is out of scope into the middle of its scope (in the block).</p>
<div class="sourceCode" id="cb626"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb626-1"><a href="goto.html#cb626-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">goto</span> label<span class="op">;</span></span>
<span id="cb626-2"><a href="goto.html#cb626-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-3"><a href="goto.html#cb626-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb626-4"><a href="goto.html#cb626-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x <span class="op">=</span> <span class="dv">12345</span><span class="op">;</span></span>
<span id="cb626-5"><a href="goto.html#cb626-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb626-6"><a href="goto.html#cb626-6" aria-hidden="true" tabindex="-1"></a>label<span class="op">:</span></span>
<span id="cb626-7"><a href="goto.html#cb626-7" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb626-8"><a href="goto.html#cb626-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>This will compile and run, but gives me a warning:</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb627-1"><a href="goto.html#cb627-1" aria-hidden="true" tabindex="-1"></a>warning: ‘x’ is used uninitialized in this function</span></code></pre></div>
<p>And then it prints out <code>0</code> when I run it (your mileage may vary).</p>
<p>Basically what has happened is that we jumped into <code>x</code>’s scope (so it was OK to reference it in the <code>printf()</code>) but we jumped over the line that actually initialized it to <code>12345</code>. So the value was indeterminate.</p>
<p>The fix is, of course, to get the initialization <em>after</em> the label one way or another.</p>
<div class="sourceCode" id="cb628"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb628-1"><a href="goto.html#cb628-1" aria-hidden="true" tabindex="-1"></a>    <span class="cf">goto</span> label<span class="op">;</span></span>
<span id="cb628-2"><a href="goto.html#cb628-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb628-3"><a href="goto.html#cb628-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb628-4"><a href="goto.html#cb628-4" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb628-5"><a href="goto.html#cb628-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb628-6"><a href="goto.html#cb628-6" aria-hidden="true" tabindex="-1"></a>label<span class="op">:</span></span>
<span id="cb628-7"><a href="goto.html#cb628-7" aria-hidden="true" tabindex="-1"></a>        x <span class="op">=</span> <span class="dv">12345</span><span class="op">;</span></span>
<span id="cb628-8"><a href="goto.html#cb628-8" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb628-9"><a href="goto.html#cb628-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>Let’s look at one more example.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb629-1"><a href="goto.html#cb629-1" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb629-2"><a href="goto.html#cb629-2" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb629-3"><a href="goto.html#cb629-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-4"><a href="goto.html#cb629-4" aria-hidden="true" tabindex="-1"></a>label<span class="op">:</span></span>
<span id="cb629-5"><a href="goto.html#cb629-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-6"><a href="goto.html#cb629-6" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;</span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> x<span class="op">);</span></span>
<span id="cb629-7"><a href="goto.html#cb629-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb629-8"><a href="goto.html#cb629-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb629-9"><a href="goto.html#cb629-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">goto</span> label<span class="op">;</span></span></code></pre></div>
<p>What happens here?</p>
<p>The first time through the block, we’re good. <code>x</code> is <code>10</code> and that’s what prints.</p>
<p>But after the <code>goto</code>, we’re jumping into the scope of <code>x</code>, but past its initialization. Which means we can still print it, but the value is indeterminate (since it hasn’t been reinitialized).</p>
<p>On my machine, it prints <code>10</code> again (to infinity), but that’s just luck. It could print any value after the <code>goto</code> since <code>x</code> is uninitialized.</p>
<p></p>
<h2 data-number="31.10" id="goto-and-variable-length-arrays"><span class="header-section-number">31.10</span> <code>goto</code> and Variable-Length Arrays</h2>
<p></p>
<p>When it comes to VLAs and <code>goto</code>, there’s one rule: you can’t jump from outside the scope of a VLA into the scope of that VLA.</p>
<p>If I try to do this:</p>
<div class="sourceCode" id="cb630"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb630-1"><a href="goto.html#cb630-1" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb630-2"><a href="goto.html#cb630-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-3"><a href="goto.html#cb630-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">goto</span> label<span class="op">;</span></span>
<span id="cb630-4"><a href="goto.html#cb630-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-5"><a href="goto.html#cb630-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb630-6"><a href="goto.html#cb630-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v<span class="op">[</span>x<span class="op">];</span></span>
<span id="cb630-7"><a href="goto.html#cb630-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-8"><a href="goto.html#cb630-8" aria-hidden="true" tabindex="-1"></a>label<span class="op">:</span></span>
<span id="cb630-9"><a href="goto.html#cb630-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb630-10"><a href="goto.html#cb630-10" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;Hi!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb630-11"><a href="goto.html#cb630-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>I get an error:</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb631-1"><a href="goto.html#cb631-1" aria-hidden="true" tabindex="-1"></a>error: jump into scope of identifier with variably modified type</span></code></pre></div>
<p>You can jump in ahead of the VLA declaration, like this:</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb632-1"><a href="goto.html#cb632-1" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb632-2"><a href="goto.html#cb632-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-3"><a href="goto.html#cb632-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">goto</span> label<span class="op">;</span></span>
<span id="cb632-4"><a href="goto.html#cb632-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-5"><a href="goto.html#cb632-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">{</span></span>
<span id="cb632-6"><a href="goto.html#cb632-6" aria-hidden="true" tabindex="-1"></a>label<span class="op">:</span>  <span class="op">;</span></span>
<span id="cb632-7"><a href="goto.html#cb632-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v<span class="op">[</span>x<span class="op">];</span></span>
<span id="cb632-8"><a href="goto.html#cb632-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb632-9"><a href="goto.html#cb632-9" aria-hidden="true" tabindex="-1"></a>        printf<span class="op">(</span><span class="st">&quot;Hi!</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb632-10"><a href="goto.html#cb632-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>Because that way the VLA gets allocated properly before its inevitable deallocation once it falls out of scope.</p>
<p> </p>
<!-- BG_NEW_CHAPTER -->
<!-- Beej's guide to C

# vim: ts=4:sw=4:nosi:et:tw=72
-->
<hr><div style="text-align:center"><span><a href="variable-length-arrays-vlas.html" rel="prev">Prev</a> | </span><a href="index.html">Contents</a><span> | <a href="types-part-v-compound-literals-and-generic-selections.html" rel="next">Next</a></span></div></body>
</html>
