<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Beej's Guide to Git</title>
  <style>
    html {
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <!-- BG custom styling -->
  <style type="text/css">
  /* Fix for line numbers not visible */
  pre.numberSource code > span {
      left: -1em;
  }
  pre.numberSource {
      margin-left: initial;
  }

  /* Put some space after the section numbers */
  span.toc-section-number::after {
      content: "\a0\a0\a0";  /* non-breaking whitespace */
  }

  /* Hide underlines on code number links */
  pre > code.sourceCode > span > a:first-child::before {
      text-decoration: none;
  }

  /* Color the source blocks */
  div.sourceCode {
      background-color: #f0f0f0;
  }

  /* Fix iOS big text rendering issue */
  pre > code.sourceCode > span {
      display: initial;
  }


  /* Color the inline code */
  code:not(.sourceCode) {
      background: #f0f0f0;
      padding-left: 0.2em;
      padding-right: 0.2em;
      border-radius: 0.2em;
  }

  pre.sourceCode {
      border: 1px solid #ccc;
      padding: 0.5em;
      border-radius: 0.2em;
  }

  /* Keep code tags from wrapping in tables */
  tbody code {
      white-space: nowrap;
  }

  /* Prevent hyphenation and hyphen breaks in code*/
  code {
      word-break: keep-all;
  }

  td {
      vertical-align: top;
  }

  body {
      font-size: 12pt;
      max-width: 43em;
      font-family: sans-serif;
  }

  html {
      background: #f9f9f9;
  }

  figure > embed {
      max-width: 100%;
  }

  figure {
      text-align: center;
      margin-top: 2em;
      margin-bottom: 2em;
  }

  figcaption {
      font-size: 0.9em;
      font-style: italic;
      margin-top: 0.6em;
  }

  body {
      counter-reset: figure-counter-major;
      counter-reset: figure-counter-minor;
  }

  figure {
      counter-increment: figure-counter-minor;
  }

  figcaption::before {
      content: "Figure " counter(figure-counter-major) "." counter(figure-counter-minor) ": ";
  }

  blockquote {
      border-left: 2px solid #bbb;
      color: #444;
  }

  /* Contents */

  nav[role="doc-toc"] > ul > li {
    font-weight: bold;
    margin-top: 1.2em;
  }

  nav[role="doc-toc"] > ul > li:first {
    font-weight: bold;
    margin-top: initial;
  }

  nav[role="doc-toc"] > ul > li > ul {
    font-weight: normal;
    margin-top: 0.3em;
  }

  /*
  In multipage, we need to reset the figure counter to the chapter
  number. Luckily, this is in the <h1 data-number> attribute. Unluckily,
  there is no way to get this in a general way.

  This doesn't work:

    h1[data-number] {
      counter-set: figure-counter-major attr(data-number);
    }

  Nor this:

    h1[data-number] {
      --figure-counter-major-value: attr(data-number);
      counter-set: figure-counter-major var(--figure-counter-major-value);
    }

  So, dumbly, we have a bunch of rules for all these sections, up to the
  maximum possible section.

  Here's a program to generate them:

    for (let i = 1; i < 100; i++)
        console.log(`h1[data-number="${i}"]{counter-set:figure-counter-major ${i};counter-reset:figure-counter-minor;}`);

  Note to self: never write a book with more than 99 frickin' chapters.
  */

  h1[data-number="1"]{counter-set:figure-counter-major 1;counter-reset:figure-counter-minor;}
  h1[data-number="2"]{counter-set:figure-counter-major 2;counter-reset:figure-counter-minor;}
  h1[data-number="3"]{counter-set:figure-counter-major 3;counter-reset:figure-counter-minor;}
  h1[data-number="4"]{counter-set:figure-counter-major 4;counter-reset:figure-counter-minor;}
  h1[data-number="5"]{counter-set:figure-counter-major 5;counter-reset:figure-counter-minor;}
  h1[data-number="6"]{counter-set:figure-counter-major 6;counter-reset:figure-counter-minor;}
  h1[data-number="7"]{counter-set:figure-counter-major 7;counter-reset:figure-counter-minor;}
  h1[data-number="8"]{counter-set:figure-counter-major 8;counter-reset:figure-counter-minor;}
  h1[data-number="9"]{counter-set:figure-counter-major 9;counter-reset:figure-counter-minor;}
  h1[data-number="10"]{counter-set:figure-counter-major 10;counter-reset:figure-counter-minor;}
  h1[data-number="11"]{counter-set:figure-counter-major 11;counter-reset:figure-counter-minor;}
  h1[data-number="12"]{counter-set:figure-counter-major 12;counter-reset:figure-counter-minor;}
  h1[data-number="13"]{counter-set:figure-counter-major 13;counter-reset:figure-counter-minor;}
  h1[data-number="14"]{counter-set:figure-counter-major 14;counter-reset:figure-counter-minor;}
  h1[data-number="15"]{counter-set:figure-counter-major 15;counter-reset:figure-counter-minor;}
  h1[data-number="16"]{counter-set:figure-counter-major 16;counter-reset:figure-counter-minor;}
  h1[data-number="17"]{counter-set:figure-counter-major 17;counter-reset:figure-counter-minor;}
  h1[data-number="18"]{counter-set:figure-counter-major 18;counter-reset:figure-counter-minor;}
  h1[data-number="19"]{counter-set:figure-counter-major 19;counter-reset:figure-counter-minor;}
  h1[data-number="20"]{counter-set:figure-counter-major 20;counter-reset:figure-counter-minor;}
  h1[data-number="21"]{counter-set:figure-counter-major 21;counter-reset:figure-counter-minor;}
  h1[data-number="22"]{counter-set:figure-counter-major 22;counter-reset:figure-counter-minor;}
  h1[data-number="23"]{counter-set:figure-counter-major 23;counter-reset:figure-counter-minor;}
  h1[data-number="24"]{counter-set:figure-counter-major 24;counter-reset:figure-counter-minor;}
  h1[data-number="25"]{counter-set:figure-counter-major 25;counter-reset:figure-counter-minor;}
  h1[data-number="26"]{counter-set:figure-counter-major 26;counter-reset:figure-counter-minor;}
  h1[data-number="27"]{counter-set:figure-counter-major 27;counter-reset:figure-counter-minor;}
  h1[data-number="28"]{counter-set:figure-counter-major 28;counter-reset:figure-counter-minor;}
  h1[data-number="29"]{counter-set:figure-counter-major 29;counter-reset:figure-counter-minor;}
  h1[data-number="30"]{counter-set:figure-counter-major 30;counter-reset:figure-counter-minor;}
  h1[data-number="31"]{counter-set:figure-counter-major 31;counter-reset:figure-counter-minor;}
  h1[data-number="32"]{counter-set:figure-counter-major 32;counter-reset:figure-counter-minor;}
  h1[data-number="33"]{counter-set:figure-counter-major 33;counter-reset:figure-counter-minor;}
  h1[data-number="34"]{counter-set:figure-counter-major 34;counter-reset:figure-counter-minor;}
  h1[data-number="35"]{counter-set:figure-counter-major 35;counter-reset:figure-counter-minor;}
  h1[data-number="36"]{counter-set:figure-counter-major 36;counter-reset:figure-counter-minor;}
  h1[data-number="37"]{counter-set:figure-counter-major 37;counter-reset:figure-counter-minor;}
  h1[data-number="38"]{counter-set:figure-counter-major 38;counter-reset:figure-counter-minor;}
  h1[data-number="39"]{counter-set:figure-counter-major 39;counter-reset:figure-counter-minor;}
  h1[data-number="40"]{counter-set:figure-counter-major 40;counter-reset:figure-counter-minor;}
  h1[data-number="41"]{counter-set:figure-counter-major 41;counter-reset:figure-counter-minor;}
  h1[data-number="42"]{counter-set:figure-counter-major 42;counter-reset:figure-counter-minor;}
  h1[data-number="43"]{counter-set:figure-counter-major 43;counter-reset:figure-counter-minor;}
  h1[data-number="44"]{counter-set:figure-counter-major 44;counter-reset:figure-counter-minor;}
  h1[data-number="45"]{counter-set:figure-counter-major 45;counter-reset:figure-counter-minor;}
  h1[data-number="46"]{counter-set:figure-counter-major 46;counter-reset:figure-counter-minor;}
  h1[data-number="47"]{counter-set:figure-counter-major 47;counter-reset:figure-counter-minor;}
  h1[data-number="48"]{counter-set:figure-counter-major 48;counter-reset:figure-counter-minor;}
  h1[data-number="49"]{counter-set:figure-counter-major 49;counter-reset:figure-counter-minor;}
  h1[data-number="50"]{counter-set:figure-counter-major 50;counter-reset:figure-counter-minor;}
  h1[data-number="51"]{counter-set:figure-counter-major 51;counter-reset:figure-counter-minor;}
  h1[data-number="52"]{counter-set:figure-counter-major 52;counter-reset:figure-counter-minor;}
  h1[data-number="53"]{counter-set:figure-counter-major 53;counter-reset:figure-counter-minor;}
  h1[data-number="54"]{counter-set:figure-counter-major 54;counter-reset:figure-counter-minor;}
  h1[data-number="55"]{counter-set:figure-counter-major 55;counter-reset:figure-counter-minor;}
  h1[data-number="56"]{counter-set:figure-counter-major 56;counter-reset:figure-counter-minor;}
  h1[data-number="57"]{counter-set:figure-counter-major 57;counter-reset:figure-counter-minor;}
  h1[data-number="58"]{counter-set:figure-counter-major 58;counter-reset:figure-counter-minor;}
  h1[data-number="59"]{counter-set:figure-counter-major 59;counter-reset:figure-counter-minor;}
  h1[data-number="60"]{counter-set:figure-counter-major 60;counter-reset:figure-counter-minor;}
  h1[data-number="61"]{counter-set:figure-counter-major 61;counter-reset:figure-counter-minor;}
  h1[data-number="62"]{counter-set:figure-counter-major 62;counter-reset:figure-counter-minor;}
  h1[data-number="63"]{counter-set:figure-counter-major 63;counter-reset:figure-counter-minor;}
  h1[data-number="64"]{counter-set:figure-counter-major 64;counter-reset:figure-counter-minor;}
  h1[data-number="65"]{counter-set:figure-counter-major 65;counter-reset:figure-counter-minor;}
  h1[data-number="66"]{counter-set:figure-counter-major 66;counter-reset:figure-counter-minor;}
  h1[data-number="67"]{counter-set:figure-counter-major 67;counter-reset:figure-counter-minor;}
  h1[data-number="68"]{counter-set:figure-counter-major 68;counter-reset:figure-counter-minor;}
  h1[data-number="69"]{counter-set:figure-counter-major 69;counter-reset:figure-counter-minor;}
  h1[data-number="70"]{counter-set:figure-counter-major 70;counter-reset:figure-counter-minor;}
  h1[data-number="71"]{counter-set:figure-counter-major 71;counter-reset:figure-counter-minor;}
  h1[data-number="72"]{counter-set:figure-counter-major 72;counter-reset:figure-counter-minor;}
  h1[data-number="73"]{counter-set:figure-counter-major 73;counter-reset:figure-counter-minor;}
  h1[data-number="74"]{counter-set:figure-counter-major 74;counter-reset:figure-counter-minor;}
  h1[data-number="75"]{counter-set:figure-counter-major 75;counter-reset:figure-counter-minor;}
  h1[data-number="76"]{counter-set:figure-counter-major 76;counter-reset:figure-counter-minor;}
  h1[data-number="77"]{counter-set:figure-counter-major 77;counter-reset:figure-counter-minor;}
  h1[data-number="78"]{counter-set:figure-counter-major 78;counter-reset:figure-counter-minor;}
  h1[data-number="79"]{counter-set:figure-counter-major 79;counter-reset:figure-counter-minor;}
  h1[data-number="80"]{counter-set:figure-counter-major 80;counter-reset:figure-counter-minor;}
  h1[data-number="81"]{counter-set:figure-counter-major 81;counter-reset:figure-counter-minor;}
  h1[data-number="82"]{counter-set:figure-counter-major 82;counter-reset:figure-counter-minor;}
  h1[data-number="83"]{counter-set:figure-counter-major 83;counter-reset:figure-counter-minor;}
  h1[data-number="84"]{counter-set:figure-counter-major 84;counter-reset:figure-counter-minor;}
  h1[data-number="85"]{counter-set:figure-counter-major 85;counter-reset:figure-counter-minor;}
  h1[data-number="86"]{counter-set:figure-counter-major 86;counter-reset:figure-counter-minor;}
  h1[data-number="87"]{counter-set:figure-counter-major 87;counter-reset:figure-counter-minor;}
  h1[data-number="88"]{counter-set:figure-counter-major 88;counter-reset:figure-counter-minor;}
  h1[data-number="89"]{counter-set:figure-counter-major 89;counter-reset:figure-counter-minor;}
  h1[data-number="90"]{counter-set:figure-counter-major 90;counter-reset:figure-counter-minor;}
  h1[data-number="91"]{counter-set:figure-counter-major 91;counter-reset:figure-counter-minor;}
  h1[data-number="92"]{counter-set:figure-counter-major 92;counter-reset:figure-counter-minor;}
  h1[data-number="93"]{counter-set:figure-counter-major 93;counter-reset:figure-counter-minor;}
  h1[data-number="94"]{counter-set:figure-counter-major 94;counter-reset:figure-counter-minor;}
  h1[data-number="95"]{counter-set:figure-counter-major 95;counter-reset:figure-counter-minor;}
  h1[data-number="96"]{counter-set:figure-counter-major 96;counter-reset:figure-counter-minor;}
  h1[data-number="97"]{counter-set:figure-counter-major 97;counter-reset:figure-counter-minor;}
  h1[data-number="98"]{counter-set:figure-counter-major 98;counter-reset:figure-counter-minor;}
  h1[data-number="99"]{counter-set:figure-counter-major 99;counter-reset:figure-counter-minor;}


  </style>
  <!-- BG custom styling for the wide body variant -->
  <!-- Gets appended after bg-css.html -->

  <style type="text/css">
  body {
      max-width: inherit;
  }
  </style>
</head>
<body>
<div style="text-align:center"><span><a href="diff.html" rel="prev">Prev</a> | </span><a href="index.html">Contents</a><span> | <a href="collaboration-across-branches.html" rel="next">Next</a></span></div><hr>
<h1 data-number="13" id="renaming-and-removing-files"><span class="header-section-number">13</span> Renaming and Removing Files</h1>
<p>This is an extension of dealing with <a href="file-states.html#file-states">file states</a>, so make sure you read that chapter first!</p>
<p>Also, I’m going to interchangeably use the terms <em>rename</em> and <em>move</em> to mean the same thing. Moving as a concept is a little more powerful because not only can it rename, but it can also move files to other directories. It’s notable because the command to rename is <code>git mv</code>.</p>
<h2 data-number="13.1" id="renaming-files"><span class="header-section-number">13.1</span> Renaming Files</h2>
<p></p>
<p>You can use the OS rename command to rename files, but if they’re in a Git repo, it’s better to <code>git mv</code> them so that Git has total awareness.</p>
<p>Git is confusingly unhelpful with this.</p>
<p>Let’s rename <code>foo.txt</code> to <code>bar.txt</code> and get a status:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb161-1"><a href="renaming-and-removing-files.html#cb161-1" aria-hidden="true" tabindex="-1"></a>$ git mv foo.txt bar.txt</span>
<span id="cb161-2"><a href="renaming-and-removing-files.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  On branch main</span>
<span id="cb161-3"><a href="renaming-and-removing-files.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  Changes to be committed:</span>
<span id="cb161-4"><a href="renaming-and-removing-files.html#cb161-4" aria-hidden="true" tabindex="-1"></a>    (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span>
<span id="cb161-5"><a href="renaming-and-removing-files.html#cb161-5" aria-hidden="true" tabindex="-1"></a>      renamed:    foo.txt -&gt; bar.txt</span></code></pre></div>
<p>So it knows the file is renamed, and the file has been moved to the stage. Like so:</p>
<ul>
<li><strong>Unmodified</strong> → <code>git mv foo.txt bar.txt</code> → <strong>Staged</strong> (as “renamed”)</li>
</ul>
<p>And if we look, we see the file has actually been renamed in the directory to <code>bar.txt</code>, as well.</p>
<p>If we make a commit at this point, the file will be renamed in the repo. Done.</p>
<p> But what if we want to undo the rename?</p>
<p>Git suggests <code>git restore --staged</code> to the rescue… But which file name to use, the old one or new one? And then what? It turns out that while you <em>can</em> use <code>git restore</code> to undo this by following it with multiple other commands, you should, in this case, ignore Git’s advice, and instead read the following section.</p>
<h2 data-number="13.2" id="unrenaming-files-from-the-stage"><span class="header-section-number">13.2</span> Unrenaming Files from the Stage</h2>
<p> Just remember this part: <strong>the easiest way to undo a Staged rename is to just do the reverse rename</strong>.</p>
<p>Let’s say we renamed and got here:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb162-1"><a href="renaming-and-removing-files.html#cb162-1" aria-hidden="true" tabindex="-1"></a>$ git mv foo.txt bar.txt    # Rename foo.txt to bar.txt</span>
<span id="cb162-2"><a href="renaming-and-removing-files.html#cb162-2" aria-hidden="true" tabindex="-1"></a>$ git status</span>
<span id="cb162-3"><a href="renaming-and-removing-files.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  On branch main</span>
<span id="cb162-4"><a href="renaming-and-removing-files.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  Changes to be committed:</span>
<span id="cb162-5"><a href="renaming-and-removing-files.html#cb162-5" aria-hidden="true" tabindex="-1"></a>    (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span>
<span id="cb162-6"><a href="renaming-and-removing-files.html#cb162-6" aria-hidden="true" tabindex="-1"></a>      renamed:    foo.txt -&gt; bar.txt</span></code></pre></div>
<p>This easiest way to revert this change is to do this:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb163-1"><a href="renaming-and-removing-files.html#cb163-1" aria-hidden="true" tabindex="-1"></a>$ git mv bar.txt foo.txt    # Rename it back to foo.txt</span>
<span id="cb163-2"><a href="renaming-and-removing-files.html#cb163-2" aria-hidden="true" tabindex="-1"></a>$ git status</span>
<span id="cb163-3"><a href="renaming-and-removing-files.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  On branch main</span>
<span id="cb163-4"><a href="renaming-and-removing-files.html#cb163-4" aria-hidden="true" tabindex="-1"></a>  nothing to commit, working tree clean</span></code></pre></div>
<p>And there you go.</p>
<p>In summary, the way to rename a file is:</p>
<ul>
<li><strong>Unmodified</strong> → <code>git mv foo.txt bar.txt</code> → <strong>Staged</strong></li>
<li><strong>Staged</strong> → <code>git commit</code> → <strong>Unmodified</strong></li>
</ul>
<p>And the way to back out of a Staged rename is to rename them back the way they were:</p>
<ul>
<li><strong>Staged</strong> → <code>git mv bar.txt foo.txt</code> → <strong>Unmodified</strong></li>
</ul>
<p> </p>
<h2 data-number="13.3" id="removing-files"><span class="header-section-number">13.3</span> Removing Files</h2>
<p></p>
<p>You can use the OS remove command to remove files, but if they’re in a git repo, it’s better to <code>git rm</code> them so that Git has total awareness.</p>
<p>And what happens might seem a little strange.</p>
<p>Let’s say we have a file <code>foo.txt</code> that has already been committed. But we decide to remove it.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb164-1"><a href="renaming-and-removing-files.html#cb164-1" aria-hidden="true" tabindex="-1"></a>$ git rm foo.txt</span>
<span id="cb164-2"><a href="renaming-and-removing-files.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  rm &#39;foo.txt&#39;         # This is Git&#39;s output</span></code></pre></div>
<p>This actually removes the file—if you look in the directory, it’s gone.</p>
<p>But let’s check the status:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb165-1"><a href="renaming-and-removing-files.html#cb165-1" aria-hidden="true" tabindex="-1"></a>$ git status</span>
<span id="cb165-2"><a href="renaming-and-removing-files.html#cb165-2" aria-hidden="true" tabindex="-1"></a>  On branch main</span>
<span id="cb165-3"><a href="renaming-and-removing-files.html#cb165-3" aria-hidden="true" tabindex="-1"></a>  Changes to be committed:</span>
<span id="cb165-4"><a href="renaming-and-removing-files.html#cb165-4" aria-hidden="true" tabindex="-1"></a>    (use &quot;git restore --staged &lt;file&gt;...&quot; to unstage)</span>
<span id="cb165-5"><a href="renaming-and-removing-files.html#cb165-5" aria-hidden="true" tabindex="-1"></a>      deleted:    foo.txt</span></code></pre></div>
<p>So the now-deleted file is in Staged State, as it were. Which makes sense since there’s now a “difference” between the working tree (where the file is gone) and the stage (where the file still exists).</p>
<p>If we do a commit here, the file is deleted. Done.</p>
<h2 data-number="13.4" id="unremoving-files-from-the-stage"><span class="header-section-number">13.4</span> Unremoving Files from the Stage</h2>
<p> But what if we want to undo the staging of the now-deleted file? There’s a hint for how to get it back with <code>git restore --staged</code>, as per usual.</p>
<p>Let’s try it:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb166-1"><a href="renaming-and-removing-files.html#cb166-1" aria-hidden="true" tabindex="-1"></a>$ git restore --staged foo.txt</span>
<span id="cb166-2"><a href="renaming-and-removing-files.html#cb166-2" aria-hidden="true" tabindex="-1"></a>$ git status</span>
<span id="cb166-3"><a href="renaming-and-removing-files.html#cb166-3" aria-hidden="true" tabindex="-1"></a>  On branch main</span>
<span id="cb166-4"><a href="renaming-and-removing-files.html#cb166-4" aria-hidden="true" tabindex="-1"></a>  Changes not staged for commit:</span>
<span id="cb166-5"><a href="renaming-and-removing-files.html#cb166-5" aria-hidden="true" tabindex="-1"></a>    (use &quot;git add/rm &lt;file&gt;...&quot; to update what will be committed)</span>
<span id="cb166-6"><a href="renaming-and-removing-files.html#cb166-6" aria-hidden="true" tabindex="-1"></a>    (use &quot;git restore &lt;file&gt;...&quot; to discard changes in working</span>
<span id="cb166-7"><a href="renaming-and-removing-files.html#cb166-7" aria-hidden="true" tabindex="-1"></a>    directory)</span>
<span id="cb166-8"><a href="renaming-and-removing-files.html#cb166-8" aria-hidden="true" tabindex="-1"></a>      deleted:    foo.txt</span>
<span id="cb166-9"><a href="renaming-and-removing-files.html#cb166-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-10"><a href="renaming-and-removing-files.html#cb166-10" aria-hidden="true" tabindex="-1"></a>  no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span></code></pre></div>
<p>Hmmm. “Changes not staged for commit” are files in Modified State. This means that <code>foo.txt</code> has been “modified”, which is, in this context, a friendlier way of saying “deleted”.</p>
<p>So we’ve backed up from Staged State to Modified State. But looking around, the file is still gone! I want my file back!</p>
<p>We want to move it back to Unmodified State, which Git once again hints how to do in the status: <code>git restore</code>. Let’s try:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb167-1"><a href="renaming-and-removing-files.html#cb167-1" aria-hidden="true" tabindex="-1"></a>$ git restore foo.txt</span>
<span id="cb167-2"><a href="renaming-and-removing-files.html#cb167-2" aria-hidden="true" tabindex="-1"></a>$ git status</span>
<span id="cb167-3"><a href="renaming-and-removing-files.html#cb167-3" aria-hidden="true" tabindex="-1"></a>  On branch main</span>
<span id="cb167-4"><a href="renaming-and-removing-files.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  nothing to commit, working tree clean</span></code></pre></div>
<p>Git’s telling us there are no Modified files here. Let’s look and see:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb168-1"><a href="renaming-and-removing-files.html#cb168-1" aria-hidden="true" tabindex="-1"></a>$ ls foo.txt</span>
<span id="cb168-2"><a href="renaming-and-removing-files.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  foo.txt</span></code></pre></div>
<p>There it is, back safe and sound.</p>
<p>So the process for deleting a committed file is a variant of what we’ve already seen:</p>
<ul>
<li><strong>Unmodified</strong> → <code>git rm foo.txt</code> → <strong>Staged</strong></li>
<li><strong>Staged</strong> → <code>git commit</code> → The file is now gone</li>
</ul>
<p>And you can undo a deleted file (as long as the delete hasn’t yet been committed) in the same way you can undo any other file states:</p>
<ul>
<li><strong>Staged</strong> → <code>git restore --staged foo.txt</code> → <strong>Modified</strong></li>
<li><strong>Modified</strong> → <code>git restore foo.txt</code> → <strong>Unmodified</strong></li>
</ul>
<p></p>
<h2 data-number="13.5" id="unremoving-files-from-earlier-commits"><span class="header-section-number">13.5</span> Unremoving Files from Earlier Commits</h2>
<p> What if there’s a file that was removed some time ago and you want it back?</p>
<ol type="1">
<li>Find the commit hash where the file exists.</li>
<li>Restore the file from that commit.</li>
</ol>
<p>Presumably you know the name of the file, but if you don’t, you’ll have to painstakingly pore over the logs with <code>git log --name-only</code> until you find it.</p>
<p>But let’s say you know the name. In this case, you can get the log for the deleted file like so (assuming the file we want is <code>foo.txt</code>):</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb169-1"><a href="renaming-and-removing-files.html#cb169-1" aria-hidden="true" tabindex="-1"></a>$ git log -- foo.txt</span>
<span id="cb169-2"><a href="renaming-and-removing-files.html#cb169-2" aria-hidden="true" tabindex="-1"></a>  commit 97bdb61727f7515d6953c965f56ef8329585f348</span>
<span id="cb169-3"><a href="renaming-and-removing-files.html#cb169-3" aria-hidden="true" tabindex="-1"></a>  Author: User &lt;user@example.com&gt;</span>
<span id="cb169-4"><a href="renaming-and-removing-files.html#cb169-4" aria-hidden="true" tabindex="-1"></a>  Date:   Sun Jan 12 11:08:33 2025 -0800</span>
<span id="cb169-5"><a href="renaming-and-removing-files.html#cb169-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-6"><a href="renaming-and-removing-files.html#cb169-6" aria-hidden="true" tabindex="-1"></a>      Removed due to horrid commit messages</span>
<span id="cb169-7"><a href="renaming-and-removing-files.html#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="renaming-and-removing-files.html#cb169-8" aria-hidden="true" tabindex="-1"></a>  commit 1c9bf4514ee90a0e65fb9b0a916765bb6c78dee6</span>
<span id="cb169-9"><a href="renaming-and-removing-files.html#cb169-9" aria-hidden="true" tabindex="-1"></a>  Author: User &lt;user@example.com&gt;</span>
<span id="cb169-10"><a href="renaming-and-removing-files.html#cb169-10" aria-hidden="true" tabindex="-1"></a>  Date:   Sun Jan 12 11:08:33 2025 -0800</span>
<span id="cb169-11"><a href="renaming-and-removing-files.html#cb169-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-12"><a href="renaming-and-removing-files.html#cb169-12" aria-hidden="true" tabindex="-1"></a>      Add the barfsplant</span>
<span id="cb169-13"><a href="renaming-and-removing-files.html#cb169-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-14"><a href="renaming-and-removing-files.html#cb169-14" aria-hidden="true" tabindex="-1"></a>  commit cc7a1940f13fca9092dbe9ce4a8e9012babd9314</span>
<span id="cb169-15"><a href="renaming-and-removing-files.html#cb169-15" aria-hidden="true" tabindex="-1"></a>  Author: User &lt;user@example.com&gt;</span>
<span id="cb169-16"><a href="renaming-and-removing-files.html#cb169-16" aria-hidden="true" tabindex="-1"></a>  Date:   Sun Jan 12 11:08:33 2025 -0800</span>
<span id="cb169-17"><a href="renaming-and-removing-files.html#cb169-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-18"><a href="renaming-and-removing-files.html#cb169-18" aria-hidden="true" tabindex="-1"></a>      Initial splungification</span></code></pre></div>
<p>There we see the history of the illustrious <code>foo.txt</code>.</p>
<p>We see it was removed in commit <code>97bdb</code>. So no point in restoring it from there (it’s already gone by then!). But the commit just <em>prior</em> to that (<code>1c9bf</code>) is the most recent version of <code>foo.txt</code> before it was deleted. That’s probably what we want. (Or maybe an earlier one if you want to go back farther in time—no law against that.)</p>
<p>And the restore is pretty easy:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb170-1"><a href="renaming-and-removing-files.html#cb170-1" aria-hidden="true" tabindex="-1"></a>$ git restore --source=1c9bf foo.txt</span>
<span id="cb170-2"><a href="renaming-and-removing-files.html#cb170-2" aria-hidden="true" tabindex="-1"></a>$ ls foo.txt</span>
<span id="cb170-3"><a href="renaming-and-removing-files.html#cb170-3" aria-hidden="true" tabindex="-1"></a>  foo.txt</span></code></pre></div>
<p>There it is! But in what state?</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb171-1"><a href="renaming-and-removing-files.html#cb171-1" aria-hidden="true" tabindex="-1"></a>$ git status</span>
<span id="cb171-2"><a href="renaming-and-removing-files.html#cb171-2" aria-hidden="true" tabindex="-1"></a>  On branch main</span>
<span id="cb171-3"><a href="renaming-and-removing-files.html#cb171-3" aria-hidden="true" tabindex="-1"></a>  Untracked files:</span>
<span id="cb171-4"><a href="renaming-and-removing-files.html#cb171-4" aria-hidden="true" tabindex="-1"></a>    (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span>
<span id="cb171-5"><a href="renaming-and-removing-files.html#cb171-5" aria-hidden="true" tabindex="-1"></a>      foo.txt</span></code></pre></div>
<p>It’s not even added yet. So if you want to bring it back to life, you’ll have to add and commit it just as if it were a brand new file.</p>
<p></p>
<h2 data-number="13.6" id="a-note-on-removing-secrets"><span class="header-section-number">13.6</span> A Note on Removing Secrets</h2>
<p></p>
<p>We’ve seen that once something is committed and deleted, it’s possible to resurrect that thing.</p>
<p>Now, let’s say you’ve committed some code that looks like this:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode default"><code class="sourceCode default"><span id="cb172-1"><a href="renaming-and-removing-files.html#cb172-1" aria-hidden="true" tabindex="-1"></a>MASTER_PASSWORD_FOR_THE_ENTIRE_COMPANY=pencil</span></code></pre></div>
<p>And then you make the horrible mistake of pushing it.</p>
<p>That’s bad enough, but let’s say it’s even worse and you pushed it to a repo on GitHub that has public access.</p>
<p>Now the entire world has your password! You’re hosed!</p>
<p>“But wait! I’ll just remove it real fast and push and no one will notice!”</p>
<p>No. The company can’t take that chance. Anyone can clone the repo and look back in the history to get the deleted file. The only recourse is to change that password immediately. Throughout the entire company. That is what <strong>must</strong> happen. Your manager is not amused.</p>
<blockquote>
<p><strong>Never, EVER commit secrets to Git.</strong> Use a dot-env<a href="quick-reference.html#fn22" class="footnote-ref" id="fnref22" role="doc-noteref"><sup>22</sup></a> file or literally anything other than committing the secret.</p>
</blockquote>
<p>Let’s make the infraction less severe. Let’s say you’ve pushed to GitHub, but it’s a private repo. It’s still kinda bad. You have to trust everyone who has access, and trust that no clones of the repo will ever end up in the hands of anyone outside the company or those of any disgruntled employees. The only recourse is to change that password.</p>
<p>Okay. Let’s make it even <em>less</em> severe, still. Let’s say you’ve committed the password to your repo, <em>but you haven’t yet pushed</em>.</p>
<p>Now we can do something about it because there’s no chance anyone other than you has seen the code. You didn’t push it, so no one can have pulled it. But we’ll not talk about that here; see the chapter on <a href="amend.html#amend">Amending Commits</a> for fixing the file before the push.</p>
<p></p>
<p></p>
<!-- BG_NEW_CHAPTER -->
<hr><div style="text-align:center"><span><a href="diff.html" rel="prev">Prev</a> | </span><a href="index.html">Contents</a><span> | <a href="collaboration-across-branches.html" rel="next">Next</a></span></div></body>
</html>
